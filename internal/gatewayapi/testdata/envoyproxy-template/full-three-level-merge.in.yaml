# Test case: Full three-level merge (Template -> GatewayClass -> Gateway)
# This test verifies the complete hierarchy where:
# 1. Template provides base defaults
# 2. GatewayClass EnvoyProxy overrides template
# 3. Gateway EnvoyProxy overrides both template and GatewayClass

envoyGateway:
  apiVersion: gateway.envoyproxy.io/v1alpha1
  kind: EnvoyGateway
  gateway:
    controllerName: gateway.envoyproxy.io/gatewayclass-controller
  provider:
    type: Kubernetes
    kubernetes:
      envoyProxyTemplate:
        provider:
          type: Kubernetes
          kubernetes:
            envoyDeployment:
              replicas: 3
              container:
                env:
                - name: TEMPLATE_ENV
                  value: template_value
                - name: SHARED_ENV
                  value: from_template
                resources:
                  requests:
                    cpu: 200m
                    memory: 1Gi
              pod:
                annotations:
                  template-annotation: template-value
                  shared-annotation: from-template
            envoyService:
              type: LoadBalancer

envoyProxyForGatewayClass:
  apiVersion: gateway.envoyproxy.io/v1alpha1
  kind: EnvoyProxy
  metadata:
    name: gatewayclass-proxy
    namespace: envoy-gateway-system
  spec:
    provider:
      type: Kubernetes
      kubernetes:
        envoyDeployment:
          replicas: 5
          container:
            env:
            - name: GATEWAYCLASS_ENV
              value: gatewayclass_value
            - name: SHARED_ENV
              value: from_gatewayclass
            image: "envoyproxy/envoy:v1.28.0"
          pod:
            annotations:
              gatewayclass-annotation: gatewayclass-value

envoyProxiesForGateways:
- apiVersion: gateway.envoyproxy.io/v1alpha1
  kind: EnvoyProxy
  metadata:
    name: gateway-proxy
    namespace: default
  spec:
    provider:
      type: Kubernetes
      kubernetes:
        envoyDeployment:
          replicas: 2
          container:
            env:
            - name: GATEWAY_ENV
              value: gateway_value
            - name: SHARED_ENV
              value: from_gateway
          pod:
            annotations:
              gateway-annotation: gateway-value
              shared-annotation: from-gateway
        envoyService:
          type: NodePort
